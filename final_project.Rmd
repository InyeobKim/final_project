---
title: "Final_project"
author: "InyeobKim"
date: "5/16/2019"
output: html_document
---
<h2>1 Preparing data</h2><br>
<h4>1.1 Load libraries and data</h4>
```{r setup, include=FALSE}
library(tidyverse)
library(tidyr)
mydat <- read.csv("./suicide.csv")
```

<h4>1.2 File structure and content</h4>
```{r}
summary(mydat)
glimpse(mydat)
```
<b><i>Attributes:</i></b><br>
<ui>
  <li><b>age</b>: There are several ranges of age(5-14, 15-24, 35-54, 55-74, 75+)</li>
  <li><b>suicides_no</b>: This column indicates a specific number of suicides happened</li>
  <li><b>population</b>: Population of a country</li>
  <li><b>suicides.100k.pop</b>: This column will be removed, since it is unnecessary</li>
  <li><b>country.year</b>: This attribute will be dropped since it is a duplicate data of country and year</li>
  <li><b>HID.for.year</b>: This column will be removed, since there are too much missing values</li>
  <li><b>generation</b>: This column categorizes people who are born in a specific range of year into several categories<br></li>
</ui>
<br>


<h4>1.3 Missing values</h4><br>
<p>Properly informed with missing data is very significant, because they indicate how much we do not know about the data set. Additionally, many models can break down when missing values are involved, so certain rows with missing data should be either removed or values need to be estimated with appropriate method.</p><br>
```{r}
sum(is.na(mydat))
```
<p>It seems there are over 19000 missing data in our data set. We need to cope with this problem before we actually plunge into exploring the data.</p><br>

<h4>1.4 Reformating dataset</h4><br>
<p>Tidying the data set is necesary for a better data exploring.</p><br>
```{r}
# dropping unnecessary columns
newdat <- mydat %>% 
  select(-HDI.for.year,  -suicides.100k.pop, -country.year)
```

```{r}
# changing names for better understanding
names(newdat)[5] <- "num_suicide"
names(newdat)[7] <- "gdp"

newdat %>% 
  head()

sum(is.na(newdat))
```
<p>First, the HDI.for.year column is dropped since there are too much missing information. Dropping HDI.for.year column made 0 missing value, which means all the missing values were in HDI.for.year column. Since we have the exact data of population, we can remove the suicides.100k.pop column. Furthermore, there exists country and year columns, so we can definitely eliminate the country.year column as well.</p><br>


<h2>2 South Korea Analysis (1985-2015)</h2><br>
<h4>2.1 Objectives</h4><br>
<p>This study aims to examine the changing trends in suicide rates in <strong>South Korea</strong> by <i>time</i>, <i>sex</i>, and <i>age</i> group.</p><br>
<h4>2.2 Design</h4><br>
<p>A descriptive study using data of mortaility rate from suicide in South Korea.</p><br>
<h4>2.3 Setting</h4><br>
<p>Data of mortality rate from suicide in South Korea in time between 1985 and 2015</p><br>
<h4>2.4 Introduction</h4><br>
<p>Suicide is a major public health issue, with an estimated 788 000 deaths every year according to the WHO statistics.1 The WHO established the Mental Health Action 2013–2020 plan to implement a national, multisectoral promotion and prevention programme for promoting mental health and reducing suicide rates of each country by 10% until 2020.2 Especially, the developed countries in East Asia have relatively high mortality rates due to suicide.3 Among these countries, suicide in South Korea is a serious health problem because the suicide rate in South Korea in 2013 (28.5 per 100 000 person-years) was 2.4 times higher than the average suicide rates of other Organisation for Economic Co-operation and Development (OECD) countries and South Korea has been ranked top among the OECD countries in terms of suicide rates in the last 10 years.4 In addition, suicide was the most common cause of death in young people aged between 10 and 39 years, and it was the second-most common cause of death among adults aged 40–59 years in 2016 in South Korea.</p><br>

<h4>2.5 Analysis</h4><br>
<h5>2.5.1 Overall Suicide rate of South Korea</h5><br>
```{r}
# filtering data only related to South Korea
korea_dat <- newdat %>% 
  filter(country == "Republic of Korea") %>% 
  filter(year <= 2015) 

# South Korea's suicide rate trend
korea_dat %>%
  group_by(year) %>% 
  summarize(population = sum(population),
            total_suicide = sum(num_suicide),
            suicide_per_100k = (total_suicide / population) * 100000) %>% 
  ggplot(aes(x = year, y = suicide_per_100k)) +
  geom_line(col = "deepskyblue3", size = 1) +
  geom_point(col = "orange", size = 2) +
  labs(title = "Suicide rate trend of South Korea (per 100k)",
       subtitle = "Trend over time, 1985 - 2015",
       x = "Year",
       y = "Suicide Rate per 100k") +
  scale_x_continuous(breaks = seq(1985, 2015, 2))

```
<br><b><i>Insights</i></b><br><br>
<ui>
  <li>Increased steadily from <b>1991</b> (<b>7.6</b> deaths per 100k) to <b>2001</b> (<b>33</b> deaths per 100k). (<b>~434%</b> increase)</li>
  <li>Reached the peak in <b>2011</b></li>
  <li>Decreased gradually, to <b>27.5</b> per 100k in <b>2015</b>. (<b>~17%</b> decrease)</li>
</ui>
<br>

<h5>2.5.2 Suicide rate of South Korea compared to other countries</h5><br>

```{r}
newdat %>% 
  # removing countries that have gdp less than $600bil
  filter(gdp == 12) %>% 
  group_by(country, year) %>% 
  summarize(population = sum(population),
            total_suicide = sum(num_suicide),
            suicide_per_100k = (total_suicide / population) * 100000) %>% 
  ggplot(aes(x = year, y = suicide_per_100k)) +
  geom_line(col = "deepskyblue3", size = 1) +
  geom_point(col = "orange", size = 2)
  
```
<h5>1.3 Suicide rate by sex</h5><br>
```{r}
korea_dat %>% 
  group_by(sex) %>% 
  summarize(suicide_per_100k = sum(num_suicide) / sum(population) * 100000) %>% 
  ggplot(aes(x = sex, y = suicide_per_100k, fill = sex)) +
  geom_bar(stat = "identity") +
  labs(title = "South Korea suicides (per 100k), by Sex",
       x = "Sex",
       y = "Suicides per 100k") +
  theme(legend.position = "bottom") + 
  scale_y_continuous(breaks = seq(0, 30, 5))
```
<br><b><i>Insights</i></b><br><br>
<ui>
  <li>Suicide rate of male is around <b>21.25</b> deaths per 100k and that of female is around <b>12.5</b> deaths per 100k</li>
  <li>The rate of suicide for men has been more than twice as high than that of female</li>
</ui>
<br>

<h5>1.4 Suicide rate by age group</h5><br>
```{r}

# age_summary <- age_summary[c(4,1,2,3,5,6),]

age_summary_korea <- korea_dat %>% 
  group_by(age) %>% 
  summarize(population = sum(population),
            total_suicide = sum(num_suicide),
            suicide_per_100k = total_suicide / population * 100000)


# change the order of the factor(age) in proper order
age_summary_korea$age <- factor(age_summary_korea$age, levels = age_summary_korea$age[order(age_summary_korea$suicide_per_100k)])

age_summary_korea %>% 
  ggplot(aes(x = age, y = suicide_per_100k, fill = age)) +
  geom_bar(stat = "identity") +
  labs(title = "South Korea suicides (per 100k), by Age",
       x = "Age",
       y = "Suicides per 100k") +
  theme(legend.position = "bottom") +
  scale_y_continuous(breaks = seq(0, 70, 5))

age_summary_korea_age_year <- korea_dat %>% 
  group_by(year, age) %>% 
  summarize(population = sum(population),
            total_suicide = sum(num_suicide),
            suicide_per_100k = total_suicide / population * 100000)

age_summary_korea_age_year %>% 
  ggplot(aes(x = year, y = suicide_per_100k, colour = age)) +
  geom_line() +
  geom_point() +
  labs(title = "South Korea suicides (per 100k), by Age",
       subtitle = "Trend from 1985 - 2015",
       x = "Year",
       y = "Suicides per 100k") +
  scale_x_continuous(breaks = seq(1985, 2015, 2)) +
  scale_y_continuous(breaks = seq(0, 100, 10))

```
<br><b><i>Insights</i></b><br><br>
<ui>
  <li>People who are <b>75+</b> has the highest suicide rate</li>
  <li>Suicide rate of age 75+ started to increase dramatically in <b>2001</b> and reached its peak in <b>2004</b></li>
  <li>It has a <b>positive correlation</b> between age and suicide rate</li>
</ui>
<br>
<h5>3.5 Suicide rate with gdp</h5><br>
<h5>3.6 Other data set</h5><br>